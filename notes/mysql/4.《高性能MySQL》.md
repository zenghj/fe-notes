[toc]

# 《高性能MySQL》

## 第四章 Schema与数据类型优化

选择存储的数据类型的原则：

* 更小的通常更好：尽量使用可以正确存储数据的最小数据类型；
* 简单就好：例如，整型比字符操作代价更低；使用MySql内建的类型而不是字符串来存储日期和时间；
* 尽量避免NULL

### 4.1 选择优化的数据类型

#### 4.1.1 整数类型

* TINYINT, SMALLINT, MEDIUNINT, INT, BIGINT分别使用8，16，24，32，64位存储空间，可存储的值的范围是-2^(N-1)到2^(N-1) - 1,其中N是存储空间的位数。
* 整数可选UNSIGNED属性，TINYINT且UNSIGNED时存储范围是0～255，有符号和无符号使用相同的存储空间，具备相同的性能。
* MySQL可以为整数类型指定宽度，例如INT(11)，指定的宽度并不会限制值的合法范围，只是规定了MySQL的一些交互工具用来显示字符的个数。对于存储来说，INT(1)和INT(20)是相同的。

#### 4.1.2 实数类型

实数是带有小数部分的数字。

#### 4.1.3 字符串类型

* VARCHAR；存储可变长度的字符串。VARCHAR可以节省存储空间，但是由于行长是可变的，这就导致了需要做额外的工作。
* CHAR; CHAR类型是定长的，相比VARCHAR,定长的CHAR类型不容易产生碎片，在存储空间上更有效率。
* BLOB和TEXT类型；用来存储很大的数据而设计的类型，分别采用二进制和字符方式存储。
* 使用枚举类型代替字符串类型; 使用枚举类型的缺点是字符串列表是固定的，添加或删除字符串必须使用ALTER TABLE。

#### 4.1.4 日期和时间类型

* 可以使用DATETIME和TIMESTAMP；
* 除特殊行为外，通常应该尽量使用TIMESTAMP，因为它比TIMESTAMP空间效率更高。

#### 4.1.5 位数据类型

#### 4.1.6 选择标识符

#### 4.1.7 特殊类型数据

### 4.2 MySQL schema设计中的陷阱

* 太多的列； 使用非常宽的表（数千个字段），会影响服务器的运行特征。
* 太多的关联；MySQL限制了每个关联操作最多只能有61张表。一个粗略的经验法则，如果希望查询执行得快速且并发性好，单个查询最好在12个表以内做关联。
* 全能的枚举；过度使用枚举，而增加新的枚举元素的时候都需要进行一次ALTER TABLE操作。
* 变相的枚举；

### 4.3 范式和反范式

## 第5章 创建高性能的索引
